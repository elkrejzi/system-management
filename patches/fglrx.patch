--- a/common/etc/ati/authatieventsd.sh	2013-03-15 19:04:04.000000000 +0100
+++ b/common/etc/ati/authatieventsd.sh	2013-03-24 19:43:14.387557413 +0100
@@ -34,8 +34,9 @@
 
     # Check xdm/kdm
 
-    XDM_AUTH_MASK=/var/lib/xdm/authdir/authfiles/A$1*
-    XDM_AUTH_FILE=`ls -t $XDM_AUTH_MASK 2>/dev/null | head -n 1`   # Choose the newest file
+    XDM_AUTH_MASK=/var/lib/xdm/authfiles/A$1*
+    KDM_AUTH_MASK=/var/run/xauth/A$1*
+    XDM_AUTH_FILE=`ls -t $XDM_AUTH_MASK $KDM_AUTH_MASK 2>/dev/null | head -n 1`   # Choose the newest file
     if [ -n "$XDM_AUTH_FILE" ]; then
         SERVER_AUTH_FILE=$XDM_AUTH_FILE
         DISP_SEARCH_STRING="#ffff#"
@@ -44,10 +45,10 @@
 
     # Check gdm
 
-    GDM_AUTH_FILE=/var/lib/gdm/$1.Xauth
+    GDM_AUTH_FILE=/var/run/gdm/auth-for-gdm-*/database
     if [ -e $GDM_AUTH_FILE ]; then
         SERVER_AUTH_FILE=$GDM_AUTH_FILE
-        DISP_SEARCH_STRING="$1"
+        DISP_SEARCH_STRING="unix$1"
         return 0
     fi
 
--- a/common/lib/modules/fglrx/build_mod/2.6.x/Makefile	2013-03-15 19:04:04.000000000 +0100
+++ b/common/lib/modules/fglrx/build_mod/2.6.x/Makefile	2013-03-24 19:43:31.424492508 +0100
@@ -68,6 +68,7 @@
                 -DFGL_GART_RESERVED_SLOT \
                 -DFGL_LINUX253P1_VMA_API \
                 -DPAGE_ATTR_FIX=$(PAGE_ATTR_FIX) \
+                -DCOMPAT_ALLOC_USER_SPACE=$(shell if grep -q compat_alloc_user_space /lib/modules/$(KERNELRELEASE)/build/Module.symvers ; then echo arch_compat_alloc_user_space ; else echo compat_alloc_user_space ; fi) \
 
 ifeq ($(KERNELRELEASE),)
 # on first call from remote location we get into this path
