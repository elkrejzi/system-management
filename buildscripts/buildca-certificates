#!/bin/bash -e

export PKGNAME=ca-certificates
export PKGVER=20161102
export PKGTAR=${PKGNAME}_${PKGVER}.tar.xz
export PKGDIR=${PKGNAME}
export PKGURL="http://http.debian.net/debian/pool/main/c/ca-certificates/${PKGTAR}"
export MAKE_JOBS_FLAGS="-j4"
export KEEP_EMPTY_DIRS=1
export NO_STRIP=1
export POSTINST_TRIGGER=("/usr/sbin/update-ca-certificates")

configure_override() {
  install -dm755 ${DEST}/etc/ca-certificates/update.d \
                 ${DEST}/etc/ssl/certs \
                 ${DEST}/usr/sbin \
                 ${DEST}/usr/share/ca-certificates
}

make_install_post() {
  install -Dm644 sbin/update-ca-certificates.8 ${DEST}/usr/share/man/man8/update-ca-certificates.8

(
echo "# Automatically generated by ca-certificates-${VER}"
echo "# see update-ca-certificates man page"
echo "# "
cd ${DEST}/usr/share/ca-certificates
find . -name '*.crt' | sort | cut -b3-
) > ${DEST}/etc/ca-certificates.conf
}

. $(dirname $0)/master.sh
